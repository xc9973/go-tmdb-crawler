# TMDB剧集爬取系统 - 用户手册

## 目录

- [系统简介](#系统简介)
- [快速开始](#快速开始)
- [Web界面使用](#web界面使用)
- [功能详解](#功能详解)
- [常见操作](#常见操作)
- [FAQ](#faq)

---

## 系统简介

TMDB剧集爬取系统是一个用于自动爬取和管理剧集数据的应用程序。主要功能包括:

- **剧集管理**: 添加、编辑、删除剧集信息
- **自动爬取**: 从TMDB API自动获取最新剧集数据
- **日历生成**: 自动生成剧集更新日历
- **Telegraph发布**: 一键发布更新到Telegraph
- **定时任务**: 自动定时刷新和发布

---

## 快速开始

### 1. 访问系统

打开浏览器,访问系统地址:

```
http://localhost:8080
```

### 2. 界面概览

系统包含以下主要页面:

- **剧集列表** (`/`) - 查看和管理所有剧集
- **剧集详情** (`/show/:id`) - 查看剧集详细信息
- **今日更新** (`/today.html`) - 查看今日更新的剧集
- **爬取日志** (`/logs.html`) - 查看爬取历史记录

### 3. 添加第一个剧集

1. 点击页面右上角的"添加剧集"按钮
2. 输入TMDB ID (例如: 95479)
3. 点击"查询并添加"
4. 系统会自动从TMDB获取剧集信息

---

## Web界面使用

### 剧集列表页面

![剧集列表页面]

#### 功能说明

**1. 搜索和过滤**

- **搜索框**: 输入剧集名称进行搜索
- **状态过滤**: 点击"全部"、"连载中"、"已完结"按钮过滤
- **排序**: 点击列标题进行排序

**2. 剧集操作**

- **查看详情**: 点击剧集名称进入详情页
- **刷新**: 点击"刷新"按钮更新剧集数据
- **编辑**: 点击"编辑"按钮修改剧集信息
- **删除**: 点击"删除"按钮删除剧集

**3. 批量操作**

- 勾选多个剧集
- 点击顶部的批量操作按钮
- 支持批量刷新、批量删除

### 剧集详情页面

![剧集详情页面]

#### 功能说明

**1. 剧集信息**

显示剧集的基本信息:
- 名称、原名
- 状态、评分
- 简介、类型
- 海报和背景图

**2. 剧集列表**

显示所有季度和集数:
- 按季度分组
- 显示每集的标题、播出日期、评分
- 点击集数查看详细信息

**3. 操作按钮**

- **刷新数据**: 从TMDB重新获取最新数据
- **导出Excel**: 导出剧集详情到Excel文件
- **查看历史**: 查看爬取历史记录

### 今日更新页面

![今日更新页面]

#### 功能说明

**1. 更新列表**

显示今日更新的所有剧集:
- 剧集名称和海报
- 季数和集数
- 集数标题
- 播出时间

**2. 发布功能**

- **发布到Telegraph**: 点击按钮发布今日更新
- **复制链接**: 复制Telegraph文章链接
- **预览**: 预览发布内容

**3. 历史发布**

查看最近的发布记录:
- 发布时间
- 文章标题
- 浏览次数
- 文章链接

### 爬取日志页面

![爬取日志页面]

#### 功能说明

**1. 日志列表**

显示所有爬取记录:
- 剧集名称
- TMDB ID
- 爬取状态
- 开始时间
- 完成时间
- 耗时

**2. 过滤功能**

- **状态过滤**: 查看成功/失败的记录
- **日期过滤**: 选择日期范围
- **搜索**: 搜索剧集名称

**3. 日志详情**

点击日志记录查看详细信息:
- 爬取的季数和集数
- 错误信息(如果有)
- 性能统计

---

## 功能详解

### 添加剧集

#### 方式1: 通过TMDB ID添加

1. 点击"添加剧集"按钮
2. 输入TMDB ID
3. 点击"查询并添加"
4. 确认信息后保存

**提示**: 可以在 [TMDB官网](https://www.themoviedb.org/) 查找剧集的TMDB ID

#### 方式2: 搜索添加

1. 点击"添加剧集"按钮
2. 点击"搜索TMDB"标签
3. 输入剧集名称
4. 从搜索结果中选择剧集
5. 点击添加

### 刷新剧集

#### 单个刷新

1. 在剧集列表中找到要刷新的剧集
2. 点击"刷新"按钮
3. 等待刷新完成

#### 批量刷新

1. 勾选多个剧集
2. 点击"批量刷新"按钮
3. 确认后开始刷新

#### 全部刷新

1. 点击页面顶部的"刷新全部"按钮
2. 确认后开始刷新所有剧集

**注意**: 刷新全部可能需要较长时间,建议在非高峰期进行

### 编辑剧集

1. 在剧集列表中点击"编辑"按钮
2. 修改剧集信息
3. 点击"保存"按钮

**可编辑的字段**:
- 剧集名称
- 状态
- 备注
- 自定义字段

### 删除剧集

1. 在剧集列表中点击"删除"按钮
2. 确认删除操作

**注意**: 删除剧集会同时删除所有相关的剧集详情,此操作不可恢复

### 查看更新日历

1. 点击导航栏的"日历"链接
2. 选择查看天数(7天/30天/90天)
3. 查看每日更新的剧集

**日历功能**:
- 显示每天的更新数量
- 按日期分组显示
- 点击日期查看详细信息
- 导出日历为Excel

### 发布到Telegraph

#### 发布今日更新

1. 进入"今日更新"页面
2. 检查更新内容
3. 点击"发布到Telegraph"按钮
4. 等待发布完成
5. 复制文章链接

#### 自定义发布

1. 进入"剧集详情"页面
2. 点击"发布"按钮
3. 自定义标题和内容
4. 点击发布

**发布选项**:
- 自动生成标题
- 自定义标题
- 添加作者信息
- 选择发布格式

---

## 常见操作

### 场景1: 追踪新剧

**目标**: 添加一个正在连载的新剧

**步骤**:

1. 在TMDB官网找到剧集的TMDB ID
   ```
   例如: 咒术回战 - TMDB ID: 95479
   ```

2. 在系统中添加剧集
   - 点击"添加剧集"
   - 输入TMDB ID: 95479
   - 点击"查询并添加"

3. 系统自动获取:
   - 剧集基本信息
   - 所有已播出的集数
   - 下一集播出时间

4. 定期刷新
   - 系统每天早上8点自动刷新
   - 或手动点击"刷新"按钮

### 场景2: 批量管理剧集

**目标**: 一次性刷新多个剧集

**步骤**:

1. 在剧集列表中勾选要刷新的剧集
2. 点击"批量刷新"按钮
3. 确认后开始批量操作
4. 查看进度和结果

**批量操作支持**:
- 批量刷新
- 批量删除
- 批量导出
- 批量修改状态

### 场景3: 生成发布内容

**目标**: 发布今日更新到Telegram频道

**步骤**:

1. 进入"今日更新"页面
2. 检查今日更新列表
3. 点击"发布到Telegraph"
4. 系统自动生成文章
5. 复制文章链接
6. 分享到Telegram频道

**发布内容格式**:
```
# 今日剧集更新 - 2026年1月11日

## 咒术回战 S01E01
两面宿傩
虎杖悠仁是一位体育无敌的高中生...
```

### 场景4: 查看历史记录

**目标**: 查看某个剧集的爬取历史

**步骤**:

1. 进入剧集详情页面
2. 点击"爬取历史"标签
3. 查看所有爬取记录
4. 点击记录查看详细信息

**历史记录包含**:
- 爬取时间
- 爬取状态
- 新增/更新的集数
- 错误信息
- 耗时统计

---

## FAQ

### 常见问题

#### Q1: TMDB ID在哪里找?

**A**: 有几种方式:

1. 访问 [TMDB官网](https://www.themoviedb.org/)
2. 搜索剧集名称
3. 在URL中查看TMDB ID
   ```
   https://www.themoviedb.org/tv/95479-jujutsu-kaisen
                        ↑这是TMDB ID
   ```

#### Q2: 刷新后数据没有更新?

**A**: 可能的原因:

1. TMDB上还没有更新
2. 网络连接问题
3. API调用限流

**解决方法**:
- 检查网络连接
- 等待一段时间再重试
- 查看爬取日志了解详细错误

#### Q3: 如何设置自动刷新?

**A**: 系统默认每天早上8点自动刷新

**自定义时间**:

1. 编辑配置文件 `.env`
2. 修改 `SCHEDULE_CRON` 变量
   ```bash
   # 每天早上8点
   SCHEDULE_CRON="0 8 * * *"
   
   # 每6小时
   SCHEDULE_CRON="0 */6 * * *"
   ```
3. 重启服务

#### Q4: Telegraph发布失败?

**A**: 可能的原因:

1. Telegraph服务不可用
2. 内容格式错误
3. 网络问题

**解决方法**:
- 检查网络连接
- 尝试简化发布内容
- 查看错误日志

#### Q5: 如何备份数据?

**A**: 备份方法:

**SQLite数据库**:
```bash
cp tmdb.db tmdb.db.backup_$(date +%Y%m%d)
```

**PostgreSQL数据库**:
```bash
pg_dump -U tmdb_user tmdb_db > backup_$(date +%Y%m%d).sql
```

**导出Excel**:
1. 进入剧集列表页面
2. 点击"导出"按钮
3. 选择导出格式

#### Q6: 系统支持多少个剧集?

**A**: 理论上无限制

**实际建议**:
- SQLite: 1000个剧集以内
- PostgreSQL: 10000个剧集以内

**性能优化**:
- 使用PostgreSQL
- 定期清理日志
- 启用缓存

#### Q7: 如何查看API文档?

**A**: API文档位置:

1. 在线文档: `/docs/API.html`
2. Markdown文档: `docs/API.md`
3. Swagger UI: `/swagger` (如果启用)

#### Q8: 可以自定义剧集信息吗?

**A**: 可以

**自定义字段**:
- 备注
- 自定义标签
- 追踪状态

**编辑方法**:
1. 进入剧集详情
2. 点击"编辑"按钮
3. 修改信息
4. 保存

刷新时自定义信息不会被覆盖

---

## 技巧和窍门

### 提高效率

1. **使用快捷键**
   - `Ctrl+F`: 搜索
   - `Ctrl+A`: 全选
   - `Delete`: 删除选中项

2. **批量操作**
   - 勾选多个剧集后批量刷新
   - 使用过滤功能快速找到目标剧集

3. **定期维护**
   - 每周清理一次日志
   - 每月备份一次数据库
   - 定期更新系统

### 数据管理

1. **分类管理**
   - 使用备注标记剧集类型
   - 按状态过滤剧集

2. **定期检查**
   - 查看爬取日志
   - 关注失败的记录
   - 及时处理错误

3. **导出备份**
   - 定期导出Excel
   - 保存重要数据

---

## 获取帮助

### 文档资源

- **API文档**: `docs/API.md`
- **部署文档**: `docs/DEPLOYMENT.md`
- **任务文档**: `任务文档2.0.md`
- **设计文档**: `设计文档2.0.md`

### 问题反馈

如果遇到问题:

1. 查看FAQ部分
2. 检查日志文件
3. 查看GitHub Issues
4. 提交新的Issue

### 联系方式

- **项目地址**: [GitHub](https://github.com/yourusername/go-tmdb-crawler)
- **问题反馈**: [Issues](https://github.com/yourusername/go-tmdb-crawler/issues)
- **邮件**: support@example.com

---

## 更新日志

### v1.0.0 (2026-01-11)

**新功能**:
- 剧集管理功能
- 自动爬取功能
- 日历生成功能
- Telegraph发布功能
- 定时任务功能

**改进**:
- 响应式界面设计
- 批量操作支持
- 搜索和过滤功能

**修复**:
- 修复了各种已知问题

---

## 附录

### 术语表

| 术语 | 说明 |
|------|------|
| TMDB | The Movie Database,一个电影和电视剧数据库 |
| TMDB ID | TMDB网站中每个剧集的唯一标识 |
| Telegraph | Telegram提供的发布平台 |
| 连载中 | 剧集正在播出 |
| 已完结 | 剧集已全部播出完毕 |
| 刷新 | 从TMDB重新获取最新数据 |

### 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+F | 搜索 |
| Ctrl+A | 全选 |
| Delete | 删除 |
| Enter | 确认 |
| Esc | 取消 |

### 浏览器兼容性

| 浏览器 | 版本要求 |
|--------|----------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

---

**文档版本**: 1.0  
**最后更新**: 2026-01-11  
**维护者**: TMDB剧集爬取系统团队
